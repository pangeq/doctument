# JavaåŸºç¡€å¸¸è§é¢è¯•é¢˜æ€»ç»“ï¼ˆä¸­ï¼‰
## é¢å‘å¯¹è±¡åŸºç¡€
### é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«
>ä¸¤è€…çš„ä¸»è¦åŒºåˆ«åœ¨äºè§£å†³é—®é¢˜çš„æ–¹å¼ä¸åŒï¼š
>- é¢å‘è¿‡ç¨‹æŠŠè§£å†³é—®é¢˜çš„è¿‡ç¨‹æ‹†æˆä¸€ä¸ªä¸ªæ–¹æ³•ï¼Œé€šè¿‡ä¸€ä¸ªä¸ªæ–¹æ³•çš„æ‰§è¡Œè§£å†³é—®é¢˜ã€‚
>- é¢å‘å¯¹è±¡ä¼šå…ˆæŠ½è±¡å‡ºå¯¹è±¡ï¼Œç„¶åç”¨å¯¹è±¡æ‰§è¡Œæ–¹æ³•çš„æ–¹å¼è§£å†³çš„é—®é¢˜ã€‚
>å¦å¤–ï¼Œé¢å‘å¯¹è±¡å¼€å‘çš„ç¨‹åºä¸€èˆ¬æ›´æ˜“ç»´æŠ¤ã€æ˜“å¤ç”¨ã€æ˜“æ‰©å±•ã€‚
>ç›¸å…³issueï¼š[é¢å‘è¿‡ç¨‹ï¼šé¢å‘è¿‡ç¨‹æ€§èƒ½æ¯”é¢å‘å¯¹è±¡é«˜ï¼Ÿï¼Ÿ](https://github.com/Snailclimb/JavaGuide/issues/431)
>xä¸‹é¢æ˜¯ä¸€ä¸ªæ±‚åœ†çš„é¢ç§¯å’Œå‘¨é•¿çš„ç¤ºä¾‹ï¼Œç®€å•åˆ†åˆ«å±•ç¤ºäº†é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹ä¸¤ç§ä¸åŒçš„è§£å†³æ–¹æ¡ˆã€‚
>**é¢å‘å¯¹è±¡ï¼š**
>```java
>public class Circle {
>    // å®šä¹‰åœ†çš„åŠå¾„
>    private double radius;
>
>    // æ„é€ å‡½æ•°
>    public Circle(double radius) {
>        this.radius = radius;
>    }
>
>    // è®¡ç®—åœ†çš„é¢ç§¯
>    public double getArea() {
>        return Math.PI * radius * radius;
>    }
>
>    // è®¡ç®—åœ†çš„å‘¨é•¿
>    public double getPerimeter() {
>        return 2 * Math.PI * radius;
>    }
>
>    public static void main(String[] args) {
>        // åˆ›å»ºä¸€ä¸ªåŠå¾„ä¸º3çš„åœ†
>        Circle circle = new Circle(3.0);
>
>        // è¾“å‡ºåœ†çš„é¢ç§¯å’Œå‘¨é•¿
>        System.out.println("åœ†çš„é¢ç§¯ä¸ºï¼š" + circle.getArea());
>        System.out.println("åœ†çš„å‘¨é•¿ä¸ºï¼š" + circle.getPerimeter());
>    }
>}
>```
>æˆ‘ä»¬ç›´æ¥å®šä¹‰äº†åœ†çš„åŠå¾„ï¼Œå¹¶ä½¿ç”¨åŠå¾„ç›´æ¥è®¡ç®—å‡ºåœ†çš„é¢ç§¯å’Œå‘¨é•¿
>

### åˆ›å»ºä¸€ä¸ªå¯¹è±¡ç”¨ä»€ä¹ˆè¿ç®—ç¬¦ï¼Ÿå¯¹è±¡å®ä½“ä¸å¯¹è±¡å¼•ç”¨æœ‰ä½•ä¸åŒï¼Ÿ
>new è¿ç®—ç¬¦ï¼Œnew åˆ›å»ºå¯¹è±¡å®ä¾‹ï¼ˆå¯¹è±¡å®ä¾‹åœ¨å †å†…å­˜ï¼‰ï¼Œå¯¹è±¡å¼•ç”¨æŒ‡å‘å¯¹è±¡å®ä¾‹ï¼ˆå¯¹è±¡å¼•ç”¨å­˜æ”¾åœ¨æ ˆå†…å­˜ä¸­ï¼‰ã€‚
>- ä¸€ä¸ªå¯¹è±¡å¼•ç”¨å¯ä»¥æŒ‡å‘0ä¸ªæˆ–1ä¸ªå¯¹è±¡ï¼ˆä¸€æ ¹ç»³å­å¯ä»¥ä¸ç³»æ°”çƒï¼Œä¹Ÿå¯ä»¥ç³»ä¸€ä¸ªæ°”çƒï¼‰
>- ä¸€ä¸ªå¯¹è±¡å¯ä»¥æœ‰nä¸ªå¼•ç”¨æŒ‡å‘å®ƒï¼ˆå¯ä»¥ç”¨næ ¹ç»³å­ç³»ä½ä¸€ä¸ªæ°”çƒï¼‰ã€‚

### å¯¹è±¡çš„ç›¸å¯¹å’Œå¼•ç”¨ç›¸ç­‰çš„åŒºåˆ«
>- å¯¹è±¡çš„ç›¸ç­‰ä¸€èˆ¬æ¯”è¾ƒçš„æ˜¯å†…å­˜ä¸­å­˜æ”¾çš„å†…å®¹æ˜¯å¦ç›¸ç­‰
>- å¼•ç”¨ç›¸ç­‰ä¸€èˆ¬æ¯”è¾ƒçš„æ˜¯ä»–ä»¬æŒ‡å‘çš„å†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰ã€‚
>è¿™é‡Œä¸¾ä¸ªä¾‹å­ï¼š
>```java
>String str1 = "hello";
>String str2 = new String("hello");
>String str3 = "hello";
>// ä½¿ç”¨ == æ¯”è¾ƒå­—ç¬¦ä¸²çš„å¼•ç”¨ç›¸ç­‰
>System.out.println(str1 == str2);
>System.out.println(str1 == str3);
>// ä½¿ç”¨ equals æ–¹æ³•æ¯”è¾ƒå­—ç¬¦ä¸²çš„ç›¸ç­‰
>System.out.println(str1.equals(str2));
>System.out.println(str1.equals(str3));
>```
>è¾“å‡ºç»“æœï¼š
>```text
>false
>true
>true
>true
>```
>ä»ä¸Šé¢çš„ä»£ç è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼š
>- str1å’Œstr2ä¸ç›¸ç­‰ï¼Œè€Œstr1å’Œstr3ç›¸ç­‰ã€‚è¿™æ˜¯å› ä¸º==è¿ç®—ç¬¦æ¯”è¾ƒçš„æ˜¯å­—ç¬¦ä¸²çš„å¼•ç”¨æ˜¯å¦ç›¸ç­‰ã€‚
>- str1ã€ str2ã€str3 ä¸‰è€…çš„å†…å®¹éƒ½ç›¸ç­‰ã€‚è¿™æ˜¯å› ä¸ºequals æ–¹æ³•æ¯”è¾ƒçš„æ˜¯å­—ç¬¦ä¸²çš„å†…å®¹ï¼Œå³ä½¿è¿™äº›å­—ç¬¦ä¸²çš„å¯¹è±¡å¼•ç”¨ä¸åŒï¼Œåªè¦å®ƒä»¬çš„å†…å®¹ç›¸ç­‰ï¼Œå°±è®¤ä¸ºå®ƒä»¬æ˜¯ç›¸ç­‰çš„ã€‚

### å¦‚æœä¸€ä¸ªç±»æ²¡æœ‰å£°æ˜æ„é€ æ–¹æ³•ï¼Œè¯¥ç¨‹åºèƒ½æ­£ç¡®æ‰§è¡Œå—ï¼Ÿ
>æ„é€ æ–¹æ³•æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–¹æ³•ï¼Œä¸»è¦ä½œç”¨æ˜¯å®Œæˆå¯¹è±¡çš„åˆå§‹åŒ–å·¥ä½œã€‚
>å¦‚æœä¸€ä¸ªç±»æ²¡æœ‰å£°æ˜æ„é€ æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œï¼å› ä¸ºä¸€ä¸ªç±»å³ä½¿æ²¡æœ‰å£°æ˜æ„é€ æ–¹æ³•ä¹Ÿä¼šæœ‰é»˜è®¤çš„ä¸å¸¦å‚æ•°çš„æ„é€ æ–¹æ³•ã€‚å¦‚æœæˆ‘ä»¬è‡ªå·±æ·»åŠ äº†ç±»çš„æ„é€ æ–¹æ³•ï¼ˆæ— è®ºæ˜¯å¦æœ‰å‚ï¼‰ï¼ŒJava å°±ä¸ä¼šæ·»åŠ é»˜è®¤çš„æ— å‚æ•°çš„æ„é€ æ–¹æ³•äº†ã€‚
>æˆ‘ä»¬ä¸€ç›´åœ¨ä¸çŸ¥ä¸è§‰åœ°ä½¿ç”¨æ„é€ æ–¹æ³•ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨åˆ›å»ºå¯¹è±¡çš„æ—¶å€™åé¢è¦åŠ ä¸€ä¸ªæ‹¬å·ï¼ˆå› ä¸ºè¦è°ƒç”¨æ— å‚çš„æ„é€ æ–¹æ³•ï¼‰ã€‚å¦‚æœæˆ‘ä»¬é‡è½½äº†æœ‰å‚çš„æ„é€ æ–¹æ³•ï¼Œè®°å¾—éƒ½è¦æŠŠæ— å‚çš„æ„é€ æ–¹æ³•ä¹Ÿå†™å‡ºæ¥ï¼ˆæ— è®ºæ˜¯å¦ç”¨åˆ°ï¼‰ï¼Œå› ä¸ºè¿™å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨åˆ›å»ºå¯¹è±¡çš„æ—¶å€™å°‘è¸©å‘ã€‚

### æ„é€ æ–¹æ³•æœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿæ˜¯å¦å¯è¢«overrideï¼Ÿ
>æ„é€ æ–¹æ³•ç‰¹ç‚¹å¦‚ä¸‹ï¼š
>- åå­—ä¸ç±»åç›¸åŒã€‚
>- æ²¡æœ‰è¿”å›å€¼ï¼Œä½†ä¸èƒ½ç”¨ void å£°æ˜æ„é€ å‡½æ•°ã€‚
>- ç”Ÿæˆç±»çš„å¯¹è±¡æ—¶è‡ªåŠ¨æ‰§è¡Œï¼Œæ— éœ€è°ƒç”¨ã€‚
>æ„é€ æ–¹æ³•ä¸èƒ½è¢« overrideï¼ˆé‡å†™ï¼‰,ä½†æ˜¯å¯ä»¥ overloadï¼ˆé‡è½½ï¼‰,æ‰€ä»¥ä½ å¯ä»¥çœ‹åˆ°ä¸€ä¸ªç±»ä¸­æœ‰å¤šä¸ªæ„é€ å‡½æ•°çš„æƒ…å†µã€‚

### é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹å¾
>å°è£…
>>å°è£…æ˜¯æŒ‡æŠŠä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€ä¿¡æ¯ï¼ˆä¹Ÿå°±æ˜¯å±æ€§ï¼‰éšè—åœ¨å¯¹è±¡å†…éƒ¨ï¼Œä¸å…è®¸å¤–éƒ¨å¯¹è±¡ç›´æ¥è®¿é—®å¯¹è±¡çš„å†…éƒ¨ä¿¡æ¯ã€‚ä½†æ˜¯å¯ä»¥æä¾›ä¸€äº›å¯ä»¥è¢«å¤–ç•Œè®¿é—®çš„æ–¹æ³•æ¥æ“ä½œå±æ€§ã€‚å°±å¥½åƒæˆ‘ä»¬çœ‹ä¸åˆ°æŒ‚åœ¨å¢™ä¸Šçš„ç©ºè°ƒçš„å†…éƒ¨çš„é›¶ä»¶ä¿¡æ¯ï¼ˆä¹Ÿå°±æ˜¯å±æ€§ï¼‰ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡é¥æ§å™¨ï¼ˆæ–¹æ³•ï¼‰æ¥æ§åˆ¶ç©ºè°ƒã€‚å¦‚æœå±æ€§ä¸æƒ³è¢«å¤–ç•Œè®¿é—®ï¼Œæˆ‘ä»¬å¤§å¯ä¸å¿…æä¾›æ–¹æ³•ç»™å¤–ç•Œè®¿é—®ã€‚ä½†æ˜¯å¦‚æœä¸€ä¸ªç±»æ²¡æœ‰æä¾›ç»™å¤–ç•Œè®¿é—®çš„æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»ä¹Ÿæ²¡æœ‰ä»€ä¹ˆæ„ä¹‰äº†ã€‚å°±å¥½åƒå¦‚æœæ²¡æœ‰ç©ºè°ƒé¥æ§å™¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ— æ³•æ“æ§ç©ºå‡‹åˆ¶å†·ï¼Œç©ºè°ƒæœ¬èº«å°±æ²¡æœ‰æ„ä¹‰äº†ï¼ˆå½“ç„¶ç°åœ¨è¿˜æœ‰å¾ˆå¤šå…¶ä»–æ–¹æ³• ï¼Œè¿™é‡Œåªæ˜¯ä¸ºäº†ä¸¾ä¾‹å­ï¼‰ã€‚
>```java
>public class Student {
>private int id;//idå±æ€§ç§æœ‰åŒ–
>private String name;//nameå±æ€§ç§æœ‰åŒ–
>
>//è·å–idçš„æ–¹æ³•
>public int getId() {
>   return id;
>}
>
>//è®¾ç½®idçš„æ–¹æ³•
>public void setId(int id) {
>   this.id = id;
>}
>
>//è·å–nameçš„æ–¹æ³•
>public String getName() {
>   return name;
>}
>
>//è®¾ç½®nameçš„æ–¹æ³•
>public void setName(String name) {
>   this.name = name;
>}
>}
>```
>ç»§æ‰¿
>>ä¸åŒç±»å‹çš„å¯¹è±¡ï¼Œç›¸äº’ä¹‹é—´ç»å¸¸æœ‰ä¸€å®šæ•°é‡çš„å…±åŒç‚¹ã€‚ä¾‹å¦‚ï¼Œå°æ˜åŒå­¦ã€å°çº¢åŒå­¦ã€å°æåŒå­¦ï¼Œéƒ½å…±äº«å­¦ç”Ÿçš„ç‰¹æ€§ï¼ˆç­çº§ã€å­¦å·ç­‰ï¼‰ã€‚åŒæ—¶ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡è¿˜å®šä¹‰äº†é¢å¤–çš„ç‰¹æ€§ä½¿å¾—ä»–ä»¬ä¸ä¼—ä¸åŒã€‚ä¾‹å¦‚å°æ˜çš„æ•°å­¦æ¯”è¾ƒå¥½ï¼Œå°çº¢çš„æ€§æ ¼æƒ¹äººå–œçˆ±ï¼›å°æçš„åŠ›æ°”æ¯”è¾ƒå¤§ã€‚ç»§æ‰¿æ˜¯ä½¿ç”¨å·²å­˜åœ¨çš„ç±»çš„å®šä¹‰ä½œä¸ºåŸºç¡€å»ºç«‹æ–°ç±»çš„æŠ€æœ¯ï¼Œæ–°ç±»çš„å®šä¹‰å¯ä»¥å¢åŠ æ–°çš„æ•°æ®æˆ–æ–°çš„åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥ç”¨çˆ¶ç±»çš„åŠŸèƒ½ï¼Œä½†ä¸èƒ½é€‰æ‹©æ€§åœ°ç»§æ‰¿çˆ¶ç±»ã€‚é€šè¿‡ä½¿ç”¨ç»§æ‰¿ï¼Œå¯ä»¥å¿«é€Ÿåœ°åˆ›å»ºæ–°çš„ç±»ï¼Œå¯ä»¥æé«˜ä»£ç çš„é‡ç”¨ï¼Œç¨‹åºçš„å¯ç»´æŠ¤æ€§ï¼ŒèŠ‚çœå¤§é‡åˆ›å»ºæ–°ç±»çš„æ—¶é—´ ï¼Œæé«˜æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡ã€‚
>**å…³äºç»§æ‰¿å¦‚ä¸‹ 3 ç‚¹è¯·è®°ä½ï¼š**
>- å­ç±»æ‹¥æœ‰çˆ¶ç±»å¯¹è±¡æ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³•ï¼ˆåŒ…æ‹¬ç§æœ‰å±æ€§å’Œç§æœ‰æ–¹æ³•ï¼‰ï¼Œä½†æ˜¯çˆ¶ç±»ä¸­çš„ç§æœ‰å±æ€§å’Œæ–¹æ³•å­ç±»æ˜¯æ— æ³•è®¿é—®ï¼Œåªæ˜¯æ‹¥æœ‰
>
>- å­ç±»å¯ä»¥æ‹¥æœ‰è‡ªå·±å±æ€§å’Œæ–¹æ³•ï¼Œå³å­ç±»å¯ä»¥å¯¹çˆ¶ç±»è¿›è¡Œæ‰©å±•ã€‚
>
>- å­ç±»å¯ä»¥ç”¨è‡ªå·±çš„æ–¹å¼å®ç°çˆ¶ç±»çš„æ–¹æ³•ã€‚ï¼ˆä»¥åä»‹ç»ï¼‰ã€‚

>å¤šæ€
>>å¤šæ€ï¼Œé¡¾åæ€ä¹‰ï¼Œè¡¨ç¤ºä¸€ä¸ªå¯¹è±¡å…·æœ‰å¤šç§çš„çŠ¶æ€ï¼Œå…·ä½“è¡¨ç°ä¸ºçˆ¶ç±»çš„å¼•ç”¨æŒ‡å‘å­ç±»çš„å®ä¾‹ã€‚
>**å¤šæ€çš„ç‰¹ç‚¹:**
>- å¯¹è±¡ç±»å‹å’Œå¼•ç”¨ç±»å‹ä¹‹é—´å…·æœ‰ç»§æ‰¿ï¼ˆç±»ï¼‰/å®ç°ï¼ˆæ¥å£ï¼‰çš„å…³ç³»ï¼›
>
>- å¼•ç”¨ç±»å‹å˜é‡å‘å‡ºçš„æ–¹æ³•è°ƒç”¨çš„åˆ°åº•æ˜¯å“ªä¸ªç±»ä¸­çš„æ–¹æ³•ï¼Œå¿…é¡»åœ¨ç¨‹åºè¿è¡ŒæœŸé—´æ‰èƒ½ç¡®å®šï¼›
>
>- å¤šæ€ä¸èƒ½è°ƒç”¨â€œåªåœ¨å­ç±»å­˜åœ¨ä½†åœ¨çˆ¶ç±»ä¸å­˜åœ¨â€çš„æ–¹æ³•ï¼›
>
>- å¦‚æœå­ç±»é‡å†™äº†çˆ¶ç±»çš„æ–¹æ³•ï¼ŒçœŸæ­£æ‰§è¡Œçš„æ˜¯å­ç±»è¦†ç›–çš„æ–¹æ³•ï¼Œå¦‚æœå­ç±»æ²¡æœ‰è¦†ç›–çˆ¶ç±»çš„æ–¹æ³•ï¼Œæ‰§è¡Œçš„æ˜¯çˆ¶ç±»çš„æ–¹æ³•ã€‚

### æ¥å£å’ŒæŠ½è±¡ç±»æœ‰ä»€ä¹ˆå…±åŒç‚¹å’ŒåŒºåˆ«ï¼Ÿ
>å…±åŒç‚¹ï¼š
>- éƒ½ä¸èƒ½è¢«å®ä¾‹åŒ–ã€‚
>- éƒ½å¯ä»¥åŒ…å«æŠ½è±¡æ–¹æ³•ã€‚
>- éƒ½å¯ä»¥æœ‰é»˜è®¤å®ç°çš„æ–¹æ³•ï¼ˆJava 8 å¯ä»¥ç”¨ default å…³é”®å­—åœ¨æ¥å£ä¸­å®šä¹‰é»˜è®¤æ–¹æ³•ï¼‰ã€‚
>
>åŒºåˆ«ï¼š
>- æ¥å£ä¸»è¦ç”¨äºå¯¹ç±»çš„è¡Œä¸ºè¿›è¡Œçº¦æŸï¼Œä½ å®ç°äº†æŸä¸ªæ¥å£å°±å…·æœ‰äº†å¯¹åº”çš„è¡Œä¸ºã€‚æŠ½è±¡ç±»ä¸»è¦ç”¨äºä»£ç å¤ç”¨ï¼Œå¼ºè°ƒçš„æ˜¯æ‰€å±å…³ç³»ã€‚
>- ä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªç±»ï¼Œä½†æ˜¯å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚
>- æ¥å£ä¸­çš„æˆå‘˜å˜é‡åªèƒ½æ˜¯ public static final ç±»å‹çš„ï¼Œä¸èƒ½è¢«ä¿®æ”¹ä¸”å¿…é¡»æœ‰åˆå§‹å€¼ï¼Œè€ŒæŠ½è±¡ç±»çš„æˆå‘˜å˜é‡é»˜è®¤ defaultï¼Œå¯åœ¨å­ç±»ä¸­è¢«é‡æ–°å®šä¹‰ï¼Œä¹Ÿå¯è¢«é‡æ–°èµ‹å€¼ã€‚

### æ·±æ‹·è´å’Œæµ…æ‹·è´åŒºåˆ«äº†è§£å—ï¼Ÿä»€ä¹ˆæ˜¯å¼•ç”¨æ‹·è´ï¼Ÿ
>å…³äºæ·±æ‹·è´å’Œæµ…æ‹·è´åŒºåˆ«ï¼Œæˆ‘è¿™é‡Œå…ˆç»™ç»“è®ºï¼š
>- **æµ…æ‹·è´** ï¼šæµ…æ‹·è´ä¼šåœ¨å †ä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼ˆåŒºåˆ«äºå¼•ç”¨æ‹·è´çš„ä¸€ç‚¹ï¼‰ï¼Œä¸è¿‡ï¼Œå¦‚æœåŸå¯¹è±¡å†…éƒ¨çš„å±æ€§æ˜¯å¼•ç”¨ç±»å‹çš„è¯ï¼Œæµ…æ‹·è´ä¼šç›´æ¥å¤åˆ¶å†…éƒ¨å¯¹è±¡çš„å¼•ç”¨åœ°å€ï¼Œä¹Ÿå°±æ˜¯è¯´æ‹·è´å¯¹è±¡å’ŒåŸå¯¹è±¡å…±ç”¨åŒä¸€ä¸ªå†…éƒ¨å¯¹è±¡ã€‚
>- **æ·±æ‹·è´** ï¼šæ·±æ‹·è´ä¼šå®Œå…¨å¤åˆ¶æ•´ä¸ªå¯¹è±¡ï¼ŒåŒ…æ‹¬è¿™ä¸ªå¯¹è±¡æ‰€åŒ…å«çš„å†…éƒ¨å¯¹è±¡ã€‚
>ä¸Šé¢çš„ç»“è®ºæ²¡æœ‰å®Œå…¨ç†è§£çš„è¯ä¹Ÿæ²¡å…³ç³»ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå…·ä½“çš„æ¡ˆä¾‹ï¼
>
>æµ…æ‹·è´
>>æµ…æ‹·è´çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼Œæˆ‘ä»¬è¿™é‡Œå®ç°äº† Cloneable æ¥å£ï¼Œå¹¶é‡å†™äº† clone() æ–¹æ³•ã€‚
>clone() æ–¹æ³•çš„å®ç°å¾ˆç®€å•ï¼Œç›´æ¥è°ƒç”¨çš„æ˜¯çˆ¶ç±» Object çš„ clone() æ–¹æ³•ã€‚
>```java
>public class Address implements Cloneable{
>  private String name;
>  // çœç•¥æ„é€ å‡½æ•°ã€Getter&Setteræ–¹æ³•
>  @Override
>  public Address clone() {
>      try {
>          return (Address) super.clone();
>      } catch (CloneNotSupportedException e) {
>          throw new AssertionError();
>      }
>  }
>}
>
>public class Person implements Cloneable {
>  private Address address;
>  // çœç•¥æ„é€ å‡½æ•°ã€Getter&Setteræ–¹æ³•
>  @Override
>  public Person clone() {
>      try {
>          Person person = (Person) super.clone();
>          return person;
>      } catch (CloneNotSupportedException e) {
>          throw new AssertionError();
>      }
>  }
>}
>```
>æµ‹è¯•ï¼š
>```java
>Person person1 = new Person(new Address("æ­¦æ±‰"));
>Person person1Copy = person1.clone();
>// true
>System.out.println(person1.getAddress() == person1Copy.getAddress());
>```
>ä»è¾“å‡ºç»“æ„å°±å¯ä»¥çœ‹å‡ºï¼Œ person 1 çš„å…‹éš†å¯¹è±¡å’Œ person 1 ä½¿ç”¨çš„ä»ç„¶æ˜¯åŒä¸€ä¸ª Address å¯¹è±¡ã€‚

>æ·±æ‹·è´
>>è¿™é‡Œæˆ‘ä»¬ç®€å•å¯¹ Person ç±»çš„ clone() æ–¹æ³•è¿›è¡Œä¿®æ”¹ï¼Œè¿å¸¦ç€è¦æŠŠ Person å¯¹è±¡å†…éƒ¨çš„ Address å¯¹è±¡ä¸€èµ·å¤åˆ¶ã€‚
>
>```java
>@Override
>public Person clone() {
>try {
>   Person person = (Person) super.clone();
>   person.setAddress(person.getAddress().clone());
>   return person;
>} catch (CloneNotSupportedException e) {
>   throw new AssertionError();
>}
>}
>
>```
>æµ‹è¯•ï¼š
>```java
>Person person1 = new Person(new Address("æ­¦æ±‰"));
>Person person1Copy = person1.clone();
>// false
>System.out.println(person1.getAddress() == person1Copy.getAddress());
>```

>ä»è¾“å‡ºç»“æ„å°±å¯ä»¥çœ‹å‡ºï¼Œè™½ç„¶ `person1` çš„å…‹éš†å¯¹è±¡å’Œ `person1` åŒ…å«çš„ `Address` å¯¹è±¡å·²ç»æ˜¯ä¸åŒçš„äº†ã€‚
> **é‚£ä»€ä¹ˆæ˜¯å¼•ç”¨æ‹·è´å‘¢ï¼Ÿ**  ç®€å•æ¥è¯´ï¼Œå¼•ç”¨æ‹·è´å°±æ˜¯ä¸¤ä¸ªä¸åŒçš„å¼•ç”¨æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚
>![æµ…æ‹·è´ã€æ·±æ‹·è´ã€å¼•ç”¨æ‹·è´](https://github.com/pangeq/doctument/blob/uat/image/java/shallow&deep-copy.png)
>

## Object
### Object ç±»çš„å¸¸è§æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ
>Object ç±»æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç±»ï¼Œæ˜¯æ‰€æœ‰ç±»çš„çˆ¶ç±»ã€‚å®ƒä¸»è¦æä¾›äº†ä»¥ä¸‹ 11 ä¸ªæ–¹æ³•ï¼š
>```java
>/**
> * native æ–¹æ³•ï¼Œç”¨äºè¿”å›å½“å‰è¿è¡Œæ—¶å¯¹è±¡çš„ Class å¯¹è±¡ï¼Œä½¿ç”¨äº† final å…³é”®å­—ä¿®é¥°ï¼Œæ•…ä¸å…è®¸å­ç±»é‡å†™ã€‚
> */
>public final native Class<?> getClass()
>/**
> * native æ–¹æ³•ï¼Œç”¨äºè¿”å›å¯¹è±¡çš„å“ˆå¸Œç ï¼Œä¸»è¦ä½¿ç”¨åœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œæ¯”å¦‚ JDK ä¸­çš„HashMapã€‚
> */
>public native int hashCode()
>/**
> * ç”¨äºæ¯”è¾ƒ 2 ä¸ªå¯¹è±¡çš„å†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰ï¼ŒString ç±»å¯¹è¯¥æ–¹æ³•è¿›è¡Œäº†é‡å†™ä»¥ç”¨äºæ¯”è¾ƒå­—ç¬¦ä¸²çš„å€¼æ˜¯å¦ç›¸ç­‰ã€‚
> */
>public boolean equals(Object obj)
>/**
> * naitive æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºå¹¶è¿”å›å½“å‰å¯¹è±¡çš„ä¸€ä»½æ‹·è´ã€‚
> */
>protected native Object clone() throws CloneNotSupportedException
>/**
> * è¿”å›ç±»çš„åå­—å®ä¾‹çš„å“ˆå¸Œç çš„ 16 è¿›åˆ¶çš„å­—ç¬¦ä¸²ã€‚å»ºè®® Object æ‰€æœ‰çš„å­ç±»éƒ½é‡å†™è¿™ä¸ªæ–¹æ³•ã€‚
> */
>public String toString()
>/**
> * native æ–¹æ³•ï¼Œå¹¶ä¸”ä¸èƒ½é‡å†™ã€‚å”¤é†’ä¸€ä¸ªåœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„çº¿ç¨‹(ç›‘è§†å™¨ç›¸å½“äºå°±æ˜¯é”çš„æ¦‚å¿µ)ã€‚å¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹åœ¨ç­‰å¾…åªä¼šä»»æ„å”¤é†’ä¸€ä¸ªã€‚
> */
>public final native void notify()
>/**
> * native æ–¹æ³•ï¼Œå¹¶ä¸”ä¸èƒ½é‡å†™ã€‚è·Ÿ notify ä¸€æ ·ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ä¼šå”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªçº¿ç¨‹ã€‚
> */
>public final native void notifyAll()
>/**
> * nativeæ–¹æ³•ï¼Œå¹¶ä¸”ä¸èƒ½é‡å†™ã€‚æš‚åœçº¿ç¨‹çš„æ‰§è¡Œã€‚æ³¨æ„ï¼šsleep æ–¹æ³•æ²¡æœ‰é‡Šæ”¾é”ï¼Œè€Œ wait æ–¹æ³•é‡Šæ”¾äº†é” ï¼Œtimeout æ˜¯ç­‰å¾…æ—¶é—´ã€‚
> */
>public final native void wait(long timeout) throws InterruptedException
>/**
> * å¤šäº† nanos å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°è¡¨ç¤ºé¢å¤–æ—¶é—´ï¼ˆä»¥æ¯«å¾®ç§’ä¸ºå•ä½ï¼ŒèŒƒå›´æ˜¯ 0-999999ï¼‰ã€‚ æ‰€ä»¥è¶…æ—¶çš„æ—¶é—´è¿˜éœ€è¦åŠ ä¸Š nanos æ¯«ç§’ã€‚ã€‚
> */
>public final void wait(long timeout, int nanos) throws InterruptedException
>/**
> * è·Ÿä¹‹å‰çš„2ä¸ªwaitæ–¹æ³•ä¸€æ ·ï¼Œåªä¸è¿‡è¯¥æ–¹æ³•ä¸€ç›´ç­‰å¾…ï¼Œæ²¡æœ‰è¶…æ—¶æ—¶é—´è¿™ä¸ªæ¦‚å¿µ
> */
>public final void wait() throws InterruptedException
>/**
> * å®ä¾‹è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶çš„æ—¶å€™è§¦å‘çš„æ“ä½œ
> */
>protected void finalize() throws Throwable { }
>```


### == å’Œ equals() çš„åŒºåˆ«
>== å¯¹äºåŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„ä½œç”¨æ•ˆæœæ˜¯ä¸åŒçš„ï¼š
>
>- å¯¹äºåŸºæœ¬æ•°æ®ç±»å‹æ¥è¯´ï¼Œ== æ¯”è¾ƒçš„æ˜¯å€¼ã€‚
>- å¯¹äºå¼•ç”¨æ•°æ®ç±»å‹æ¥è¯´ï¼Œ== æ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚
>>å› ä¸º Java åªæœ‰å€¼ä¼ é€’ï¼Œæ‰€ä»¥ï¼Œå¯¹äº == æ¥è¯´ï¼Œä¸ç®¡æ˜¯æ¯”è¾ƒåŸºæœ¬æ•°æ®ç±»å‹ï¼Œè¿˜æ˜¯å¼•ç”¨æ•°æ®ç±»å‹çš„å˜é‡ï¼Œå…¶æœ¬è´¨æ¯”è¾ƒçš„éƒ½æ˜¯å€¼ï¼Œåªæ˜¯å¼•ç”¨ç±»å‹å˜é‡å­˜çš„å€¼æ˜¯å¯¹è±¡çš„åœ°å€ã€‚
>

>equals() ä¸èƒ½ç”¨äºåˆ¤æ–­åŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡ï¼Œåªèƒ½ç”¨æ¥åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚equals()æ–¹æ³•å­˜åœ¨äºObjectç±»ä¸­ï¼Œè€ŒObjectç±»æ˜¯æ‰€æœ‰ç±»çš„ç›´æ¥æˆ–é—´æ¥çˆ¶ç±»ï¼Œå› æ­¤æ‰€æœ‰çš„ç±»éƒ½æœ‰equals()æ–¹æ³•ã€‚
>Object ç±» equals() æ–¹æ³•ï¼š
>```java
>public boolean equals(Object obj) {
>     return (this == obj);
>}
>```

>equals() æ–¹æ³•å­˜åœ¨ä¸¤ç§ä½¿ç”¨æƒ…å†µï¼š
>- ç±»æ²¡æœ‰é‡å†™ equals()æ–¹æ³•ï¼šé€šè¿‡equals()æ¯”è¾ƒè¯¥ç±»çš„ä¸¤ä¸ªå¯¹è±¡æ—¶ï¼Œç­‰ä»·äºé€šè¿‡â€œ==â€æ¯”è¾ƒè¿™ä¸¤ä¸ªå¯¹è±¡ï¼Œä½¿ç”¨çš„é»˜è®¤æ˜¯ Objectç±»equals()æ–¹æ³•ã€‚
>- ç±»é‡å†™äº† equals()æ–¹æ³•ï¼šä¸€èˆ¬æˆ‘ä»¬éƒ½é‡å†™ equals()æ–¹æ³•æ¥æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡ä¸­çš„å±æ€§æ˜¯å¦ç›¸ç­‰ï¼›è‹¥å®ƒä»¬çš„å±æ€§ç›¸ç­‰ï¼Œåˆ™è¿”å› true(å³ï¼Œè®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰)ã€‚
>ä¸¾ä¸ªä¾‹å­ï¼ˆè¿™é‡Œåªæ˜¯ä¸ºäº†ä¸¾ä¾‹ã€‚å®é™…ä¸Šï¼Œä½ æŒ‰ç…§ä¸‹é¢è¿™ç§å†™æ³•çš„è¯ï¼Œåƒ IDEA è¿™ç§æ¯”è¾ƒæ™ºèƒ½çš„ IDE éƒ½ä¼šæç¤ºä½ å°† == æ¢æˆ equals() ï¼‰ï¼š
>```java
>String a = new String("ab"); // a ä¸ºä¸€ä¸ªå¼•ç”¨
>String b = new String("ab"); // bä¸ºå¦ä¸€ä¸ªå¼•ç”¨,å¯¹è±¡çš„å†…å®¹ä¸€æ ·
>String aa = "ab"; // æ”¾åœ¨å¸¸é‡æ± ä¸­
>String bb = "ab"; // ä»å¸¸é‡æ± ä¸­æŸ¥æ‰¾
>System.out.println(aa == bb);// true
>System.out.println(a == b);// false
>System.out.println(a.equals(b));// true
>System.out.println(42 == 42.0);// true
>```
>
>String ä¸­çš„ equals æ–¹æ³•æ˜¯è¢«é‡å†™è¿‡çš„ï¼Œå› ä¸º Object çš„ equals æ–¹æ³•æ˜¯æ¯”è¾ƒçš„å¯¹è±¡çš„å†…å­˜åœ°å€ï¼Œè€Œ String çš„ equals æ–¹æ³•æ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„å€¼ã€‚
>å½“åˆ›å»º String ç±»å‹çš„å¯¹è±¡æ—¶ï¼Œè™šæ‹Ÿæœºä¼šåœ¨å¸¸é‡æ± ä¸­æŸ¥æ‰¾æœ‰æ²¡æœ‰å·²ç»å­˜åœ¨çš„å€¼å’Œè¦åˆ›å»ºçš„å€¼ç›¸åŒçš„å¯¹è±¡ï¼Œå¦‚æœæœ‰å°±æŠŠå®ƒèµ‹ç»™å½“å‰å¼•ç”¨ã€‚å¦‚æœæ²¡æœ‰å°±åœ¨å¸¸é‡æ± ä¸­é‡æ–°åˆ›å»ºä¸€ä¸ª String å¯¹è±¡ã€‚
>Stringç±»equals()æ–¹æ³•ï¼š
>```java
>public boolean equals(Object anObject) {
>    if (this == anObject) {
>        return true;
>    }
>    if (anObject instanceof String) {
>        String anotherString = (String)anObject;
>        int n = value.length;
>        if (n == anotherString.value.length) {
>            char v1[] = value;
>            char v2[] = anotherString.value;
>            int i = 0;
>            while (n-- != 0) {
>                if (v1[i] != v2[i])
>                    return false;
>                i++;
>            }
>            return true;
>        }
>    }
>    return false;
>}
>```

### hashCode() æœ‰ä»€ä¹ˆç”¨ï¼Ÿ
>hashCode() çš„ä½œç”¨æ˜¯è·å–å“ˆå¸Œç ï¼ˆint æ•´æ•°ï¼‰ï¼Œä¹Ÿç§°ä¸ºæ•£åˆ—ç ã€‚è¿™ä¸ªå“ˆå¸Œç çš„ä½œç”¨æ˜¯ç¡®å®šè¯¥å¯¹è±¡åœ¨å“ˆå¸Œè¡¨ä¸­çš„ç´¢å¼•ä½ç½®ã€‚
>![hashCode() æ–¹æ³•](https://github.com/pangeq/doctument/blob/uat/image/java/java-hashcode-method.png)
>hashCode() å®šä¹‰åœ¨ JDK çš„ Object ç±»ä¸­ï¼Œè¿™å°±æ„å‘³ç€ Java ä¸­çš„ä»»ä½•ç±»éƒ½åŒ…å«æœ‰ hashCode() å‡½æ•°ã€‚å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼šObject çš„ hashCode() æ–¹æ³•æ˜¯æœ¬åœ°æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ç”¨ C è¯­è¨€æˆ– C++ å®ç°çš„ã€‚
>âš ï¸ æ³¨æ„ï¼šè¯¥æ–¹æ³•åœ¨ Oracle OpenJDK8 ä¸­é»˜è®¤æ˜¯ "ä½¿ç”¨çº¿ç¨‹å±€éƒ¨çŠ¶æ€æ¥å®ç° Marsaglia's xor-shift éšæœºæ•°ç”Ÿæˆ", å¹¶ä¸æ˜¯ "åœ°å€" æˆ–è€… "åœ°å€è½¬æ¢è€Œæ¥", ä¸åŒ JDK/VM å¯èƒ½ä¸åŒåœ¨ Oracle OpenJDK8 ä¸­æœ‰å…­ç§ç”Ÿæˆæ–¹å¼ (å…¶ä¸­ç¬¬äº”ç§æ˜¯è¿”å›åœ°å€), é€šè¿‡æ·»åŠ  VM å‚æ•°: -XX:hashCode=4 å¯ç”¨ç¬¬äº”ç§ã€‚å‚è€ƒæºç :
>- https://hg.openjdk.org/jdk8u/jdk8u/hotspot/file/87ee5ee27509/src/share/vm/runtime/globals.hppï¼ˆ1127è¡Œï¼‰
>- https://hg.openjdk.org/jdk8u/jdk8u/hotspot/file/87ee5ee27509/src/share/vm/runtime/synchronizer.cppï¼ˆ537è¡Œå¼€å§‹ï¼‰
>```java
>public native int hashCode();
>```
>æ•£åˆ—è¡¨å­˜å‚¨çš„æ˜¯é”®å€¼å¯¹(key-value)ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯ï¼šèƒ½æ ¹æ®â€œé”®â€å¿«é€Ÿçš„æ£€ç´¢å‡ºå¯¹åº”çš„â€œå€¼â€ã€‚è¿™å…¶ä¸­å°±åˆ©ç”¨åˆ°äº†æ•£åˆ—ç ï¼ï¼ˆå¯ä»¥å¿«é€Ÿæ‰¾åˆ°æ‰€éœ€è¦çš„å¯¹è±¡)

### ä¸ºä»€ä¹ˆè¦æœ‰ hashCodeï¼Ÿ
>æˆ‘ä»¬ä»¥â€œHashSet å¦‚ä½•æ£€æŸ¥é‡å¤â€ä¸ºä¾‹å­æ¥è¯´æ˜ä¸ºä»€ä¹ˆè¦æœ‰ hashCodeï¼Ÿ
>ä¸‹é¢è¿™æ®µå†…å®¹æ‘˜è‡ªæˆ‘çš„ Java å¯è’™ä¹¦ã€ŠHead First Javaã€‹:
>>å½“ä½ æŠŠå¯¹è±¡åŠ å…¥ HashSet æ—¶ï¼ŒHashSet ä¼šå…ˆè®¡ç®—å¯¹è±¡çš„ hashCode å€¼æ¥åˆ¤æ–­å¯¹è±¡åŠ å…¥çš„ä½ç½®ï¼ŒåŒæ—¶ä¹Ÿä¼šä¸å…¶ä»–å·²ç»åŠ å…¥çš„å¯¹è±¡çš„ hashCode å€¼ä½œæ¯”è¾ƒï¼Œå¦‚æœæ²¡æœ‰ç›¸ç¬¦çš„ hashCodeï¼ŒHashSet ä¼šå‡è®¾å¯¹è±¡æ²¡æœ‰é‡å¤å‡ºç°ã€‚ä½†æ˜¯å¦‚æœå‘ç°æœ‰ç›¸åŒ hashCode å€¼çš„å¯¹è±¡ï¼Œè¿™æ—¶ä¼šè°ƒç”¨ equals() æ–¹æ³•æ¥æ£€æŸ¥ hashCode ç›¸ç­‰çš„å¯¹è±¡æ˜¯å¦çœŸçš„ç›¸åŒã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼ŒHashSet å°±ä¸ä¼šè®©å…¶åŠ å…¥æ“ä½œæˆåŠŸã€‚å¦‚æœä¸åŒçš„è¯ï¼Œå°±ä¼šé‡æ–°æ•£åˆ—åˆ°å…¶ä»–ä½ç½®ã€‚è¿™æ ·æˆ‘ä»¬å°±å¤§å¤§å‡å°‘äº† equals çš„æ¬¡æ•°ï¼Œç›¸åº”å°±å¤§å¤§æé«˜äº†æ‰§è¡Œé€Ÿåº¦ã€‚
>
>å…¶å®ï¼Œ hashCode() å’Œ equals()éƒ½æ˜¯ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚
>é‚£ä¸ºä»€ä¹ˆ JDK è¿˜è¦åŒæ—¶æä¾›è¿™ä¸¤ä¸ªæ–¹æ³•å‘¢ï¼Ÿ
>è¿™æ˜¯å› ä¸ºåœ¨ä¸€äº›å®¹å™¨ï¼ˆæ¯”å¦‚ HashMapã€HashSetï¼‰ä¸­ï¼Œæœ‰äº† hashCode() ä¹‹åï¼Œåˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨å¯¹åº”å®¹å™¨ä¸­çš„æ•ˆç‡ä¼šæ›´é«˜ï¼ˆå‚è€ƒæ·»åŠ å…ƒç´ è¿›HashSetçš„è¿‡ç¨‹ï¼‰ï¼
>æˆ‘ä»¬åœ¨å‰é¢ä¹Ÿæåˆ°äº†æ·»åŠ å…ƒç´ è¿›HashSetçš„è¿‡ç¨‹ï¼Œå¦‚æœ HashSet åœ¨å¯¹æ¯”çš„æ—¶å€™ï¼ŒåŒæ ·çš„ hashCode æœ‰å¤šä¸ªå¯¹è±¡ï¼Œå®ƒä¼šç»§ç»­ä½¿ç”¨ equals() æ¥åˆ¤æ–­æ˜¯å¦çœŸçš„ç›¸åŒã€‚ä¹Ÿå°±æ˜¯è¯´ hashCode å¸®åŠ©æˆ‘ä»¬å¤§å¤§ç¼©å°äº†æŸ¥æ‰¾æˆæœ¬ã€‚
> **é‚£ä¸ºä»€ä¹ˆä¸åªæä¾› hashCode() æ–¹æ³•å‘¢?**
>è¿™æ˜¯å› ä¸ºä¸¤ä¸ªå¯¹è±¡çš„hashCode å€¼ç›¸ç­‰å¹¶ä¸ä»£è¡¨ä¸¤ä¸ªå¯¹è±¡å°±ç›¸ç­‰ã€‚
>**é‚£ä¸ºä»€ä¹ˆä¸¤ä¸ªå¯¹è±¡æœ‰ç›¸åŒçš„ hashCode å€¼ï¼Œå®ƒä»¬ä¹Ÿä¸ä¸€å®šæ˜¯ç›¸ç­‰çš„ï¼Ÿ**
>å› ä¸º hashCode() æ‰€ä½¿ç”¨çš„å“ˆå¸Œç®—æ³•ä¹Ÿè®¸åˆšå¥½ä¼šè®©å¤šä¸ªå¯¹è±¡ä¼ å›ç›¸åŒçš„å“ˆå¸Œå€¼ã€‚è¶Šç³Ÿç³•çš„å“ˆå¸Œç®—æ³•è¶Šå®¹æ˜“ç¢°æ’ï¼Œä½†è¿™ä¹Ÿä¸æ•°æ®å€¼åŸŸåˆ†å¸ƒçš„ç‰¹æ€§æœ‰å…³ï¼ˆæ‰€è°“å“ˆå¸Œç¢°æ’ä¹Ÿå°±æ˜¯æŒ‡çš„æ˜¯ä¸åŒçš„å¯¹è±¡å¾—åˆ°ç›¸åŒçš„ hashCode )ã€‚
>æ€»ç»“ä¸‹æ¥å°±æ˜¯ï¼š
>- å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„hashCode å€¼ç›¸ç­‰ï¼Œé‚£è¿™ä¸¤ä¸ªå¯¹è±¡ä¸ä¸€å®šç›¸ç­‰ï¼ˆå“ˆå¸Œç¢°æ’ï¼‰ã€‚
>- å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„hashCode å€¼ç›¸ç­‰å¹¶ä¸”equals()æ–¹æ³•ä¹Ÿè¿”å› trueï¼Œæˆ‘ä»¬æ‰è®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ã€‚
>- å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„hashCode å€¼ä¸ç›¸ç­‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ä¸ç›¸ç­‰ã€‚
>ç›¸ä¿¡å¤§å®¶çœ‹äº†æˆ‘å‰é¢å¯¹ hashCode() å’Œ equals() çš„ä»‹ç»ä¹‹åï¼Œä¸‹é¢è¿™ä¸ªé—®é¢˜å·²ç»éš¾ä¸å€’ä½ ä»¬äº†ã€‚

### ä¸ºä»€ä¹ˆé‡å†™ equals() æ—¶å¿…é¡»é‡å†™ hashCode() æ–¹æ³•ï¼Ÿ
>å› ä¸ºä¸¤ä¸ªç›¸ç­‰çš„å¯¹è±¡çš„ hashCode å€¼å¿…é¡»æ˜¯ç›¸ç­‰ã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æœ equals æ–¹æ³•åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯ç›¸ç­‰çš„ï¼Œé‚£è¿™ä¸¤ä¸ªå¯¹è±¡çš„ hashCode å€¼ä¹Ÿè¦ç›¸ç­‰ã€‚
>å¦‚æœé‡å†™ equals() æ—¶æ²¡æœ‰é‡å†™ hashCode() æ–¹æ³•çš„è¯å°±å¯èƒ½ä¼šå¯¼è‡´ equals æ–¹æ³•åˆ¤æ–­æ˜¯ç›¸ç­‰çš„ä¸¤ä¸ªå¯¹è±¡ï¼ŒhashCode å€¼å´ä¸ç›¸ç­‰ã€‚
>æ€è€ƒï¼šé‡å†™ equals() æ—¶æ²¡æœ‰é‡å†™ hashCode() æ–¹æ³•çš„è¯ï¼Œä½¿ç”¨ HashMap å¯èƒ½ä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ã€‚
>æ€»ç»“ï¼š
>- equals æ–¹æ³•åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯ç›¸ç­‰çš„ï¼Œé‚£è¿™ä¸¤ä¸ªå¯¹è±¡çš„ hashCode å€¼ä¹Ÿè¦ç›¸ç­‰ã€‚
>- ä¸¤ä¸ªå¯¹è±¡æœ‰ç›¸åŒçš„ hashCode å€¼ï¼Œä»–ä»¬ä¹Ÿä¸ä¸€å®šæ˜¯ç›¸ç­‰çš„ï¼ˆå“ˆå¸Œç¢°æ’ï¼‰ã€‚
>
>æ›´å¤šå…³äº hashCode() å’Œ equals() çš„å†…å®¹å¯ä»¥æŸ¥çœ‹ï¼š[Java hashCode() å’Œ equals()çš„è‹¥å¹²é—®é¢˜è§£ç­”](https://www.cnblogs.com/skywang12345/p/3324958.html)

## String
### Stringã€StringBufferã€StringBuilder çš„åŒºåˆ«ï¼Ÿ
> **å¯å˜æ€§**
>String æ˜¯ä¸å¯å˜çš„ï¼ˆåé¢ä¼šè¯¦ç»†åˆ†æåŸå› ï¼‰ã€‚
>StringBuilder ä¸ StringBuffer éƒ½ç»§æ‰¿è‡ª AbstractStringBuilder ç±»ï¼Œåœ¨ AbstractStringBuilder ä¸­ä¹Ÿæ˜¯ä½¿ç”¨å­—ç¬¦æ•°ç»„ä¿å­˜å­—ç¬¦ä¸²ï¼Œä¸è¿‡æ²¡æœ‰ä½¿ç”¨ final å’Œ private å…³é”®å­—ä¿®é¥°ï¼Œæœ€å…³é”®çš„æ˜¯è¿™ä¸ª AbstractStringBuilder ç±»è¿˜æä¾›äº†å¾ˆå¤šä¿®æ”¹å­—ç¬¦ä¸²çš„æ–¹æ³•æ¯”å¦‚ append æ–¹æ³•ã€‚
> ```java
> abstract class AbstractStringBuilder implements Appendable, CharSequence {
>     char[] value;
>     public AbstractStringBuilder append(String str) {
>         if (str == null)
>             return appendNull();
>         int len = str.length();
>         ensureCapacityInternal(count + len);
>         str.getChars(0, len, value, count);
>         count += len;
>         return this;
>     }
>   	//...
> }
> ```
> ***çº¿æ€§å®‰å…¨*
>String ä¸­çš„å¯¹è±¡æ˜¯ä¸å¯å˜çš„ï¼Œä¹Ÿå°±å¯ä»¥ç†è§£ä¸ºå¸¸é‡ï¼Œçº¿ç¨‹å®‰å…¨ã€‚AbstractStringBuilder æ˜¯ StringBuilder ä¸ StringBuffer çš„å…¬å…±çˆ¶ç±»ï¼Œå®šä¹‰äº†ä¸€äº›å­—ç¬¦ä¸²çš„åŸºæœ¬æ“ä½œï¼Œå¦‚ expandCapacityã€appendã€insertã€indexOf ç­‰å…¬å…±æ–¹æ³•ã€‚StringBuffer å¯¹æ–¹æ³•åŠ äº†åŒæ­¥é”æˆ–è€…å¯¹è°ƒç”¨çš„æ–¹æ³•åŠ äº†åŒæ­¥é”ï¼Œæ‰€ä»¥æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚StringBuilder å¹¶æ²¡æœ‰å¯¹æ–¹æ³•è¿›è¡ŒåŠ åŒæ­¥é”ï¼Œæ‰€ä»¥æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚
>**æ€§èƒ½**
>æ¯æ¬¡å¯¹ String ç±»å‹è¿›è¡Œæ”¹å˜çš„æ—¶å€™ï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ String å¯¹è±¡ï¼Œç„¶åå°†æŒ‡é’ˆæŒ‡å‘æ–°çš„ String å¯¹è±¡ã€‚StringBuffer æ¯æ¬¡éƒ½ä¼šå¯¹ StringBuffer å¯¹è±¡æœ¬èº«è¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯ç”Ÿæˆæ–°çš„å¯¹è±¡å¹¶æ”¹å˜å¯¹è±¡å¼•ç”¨ã€‚ç›¸åŒæƒ…å†µä¸‹ä½¿ç”¨ StringBuilder ç›¸æ¯”ä½¿ç”¨ StringBuffer ä»…èƒ½è·å¾— 10%~15% å·¦å³çš„æ€§èƒ½æå‡ï¼Œä½†å´è¦å†’å¤šçº¿ç¨‹ä¸å®‰å…¨çš„é£é™©ã€‚
>**å¯¹äºä¸‰è€…ä½¿ç”¨çš„æ€»ç»“ï¼š**
>- æ“ä½œå°‘é‡çš„æ•°æ®: é€‚ç”¨ String
>- å•çº¿ç¨‹æ“ä½œå­—ç¬¦ä¸²ç¼“å†²åŒºä¸‹æ“ä½œå¤§é‡æ•°æ®: é€‚ç”¨ StringBuilder
>- å¤šçº¿ç¨‹æ“ä½œå­—ç¬¦ä¸²ç¼“å†²åŒºä¸‹æ“ä½œå¤§é‡æ•°æ®: é€‚ç”¨ StringBuffer

### String ä¸ºä»€ä¹ˆæ˜¯ä¸å¯å˜çš„?
>String ç±»ä¸­ä½¿ç”¨ final å…³é”®å­—ä¿®é¥°å­—ç¬¦æ•°ç»„æ¥ä¿å­˜å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥String å¯¹è±¡æ˜¯ä¸å¯å˜çš„ã€‚
>```java
>public final class String implements java.io.Serializable, Comparable<String>, CharSequence {
>    private final char value[];
>	//...
>}
>```

>ğŸ› ä¿®æ­£ï¼šæˆ‘ä»¬çŸ¥é“è¢« final å…³é”®å­—ä¿®é¥°çš„ç±»ä¸èƒ½è¢«ç»§æ‰¿ï¼Œä¿®é¥°çš„æ–¹æ³•ä¸èƒ½è¢«é‡å†™ï¼Œä¿®é¥°çš„å˜é‡æ˜¯åŸºæœ¬æ•°æ®ç±»å‹åˆ™å€¼ä¸èƒ½æ”¹å˜ï¼Œä¿®é¥°çš„å˜é‡æ˜¯å¼•ç”¨ç±»å‹åˆ™ä¸èƒ½å†æŒ‡å‘å…¶ä»–å¯¹è±¡ã€‚å› æ­¤ï¼Œfinal å…³é”®å­—ä¿®é¥°çš„æ•°ç»„ä¿å­˜å­—ç¬¦ä¸²å¹¶ä¸æ˜¯ String ä¸å¯å˜çš„æ ¹æœ¬åŸå› ï¼Œå› ä¸ºè¿™ä¸ªæ•°ç»„ä¿å­˜çš„å­—ç¬¦ä¸²æ˜¯å¯å˜çš„ï¼ˆfinal ä¿®é¥°å¼•ç”¨ç±»å‹å˜é‡çš„æƒ…å†µï¼‰ã€‚
>String çœŸæ­£ä¸å¯å˜æœ‰ä¸‹é¢å‡ ç‚¹åŸå› ï¼š
>- ä¿å­˜å­—ç¬¦ä¸²çš„æ•°ç»„è¢« final ä¿®é¥°ä¸”ä¸ºç§æœ‰çš„ï¼Œå¹¶ä¸”String ç±»æ²¡æœ‰æä¾›/æš´éœ²ä¿®æ”¹è¿™ä¸ªå­—ç¬¦ä¸²çš„æ–¹æ³•ã€‚
>- String ç±»è¢« final ä¿®é¥°å¯¼è‡´å…¶ä¸èƒ½è¢«ç»§æ‰¿ï¼Œè¿›è€Œé¿å…äº†å­ç±»ç ´å String ä¸å¯å˜ã€‚
>ç›¸å…³é˜…è¯»ï¼š[å¦‚ä½•ç†è§£ String ç±»å‹å€¼çš„ä¸å¯å˜ï¼Ÿ](https://www.zhihu.com/question/20618891/answer/114125846) - çŸ¥ä¹æé—®
>è¡¥å……ï¼ˆæ¥è‡ª[issue 675](https://github.com/Snailclimb/JavaGuide/issues/675)ï¼‰ï¼šåœ¨ Java 9 ä¹‹åï¼ŒStringã€StringBuilder ä¸ StringBuffer çš„å®ç°æ”¹ç”¨ byte æ•°ç»„å­˜å‚¨å­—ç¬¦ä¸²ã€‚
>```java
>public final class String implements java.io.Serializable,Comparable<String>, CharSequence {
>    // @Stable æ³¨è§£è¡¨ç¤ºå˜é‡æœ€å¤šè¢«ä¿®æ”¹ä¸€æ¬¡ï¼Œç§°ä¸ºâ€œç¨³å®šçš„â€ã€‚
>    @Stable
>    private final byte[] value;
>}
>
>abstract class AbstractStringBuilder implements Appendable, CharSequence {
>    byte[] value;
>
>}
>```

>Java 9 ä¸ºä½•è¦å°† String çš„åº•å±‚å®ç°ç”± char[] æ”¹æˆäº† byte[] ?
>æ–°ç‰ˆçš„ String å…¶å®æ”¯æŒä¸¤ä¸ªç¼–ç æ–¹æ¡ˆï¼šLatin-1 å’Œ UTF-16ã€‚å¦‚æœå­—ç¬¦ä¸²ä¸­åŒ…å«çš„æ±‰å­—æ²¡æœ‰è¶…è¿‡ Latin-1 å¯è¡¨ç¤ºèŒƒå›´å†…çš„å­—ç¬¦ï¼Œé‚£å°±ä¼šä½¿ç”¨ Latin-1 ä½œä¸ºç¼–ç æ–¹æ¡ˆã€‚Latin-1 ç¼–ç æ–¹æ¡ˆä¸‹ï¼Œbyte å ä¸€ä¸ªå­—èŠ‚(8 ä½)ï¼Œchar å ç”¨ 2 ä¸ªå­—èŠ‚ï¼ˆ16ï¼‰ï¼Œbyte ç›¸è¾ƒ char èŠ‚çœä¸€åŠçš„å†…å­˜ç©ºé—´ã€‚JDK å®˜æ–¹å°±è¯´äº†ç»å¤§éƒ¨åˆ†å­—ç¬¦ä¸²å¯¹è±¡åªåŒ…å«Latin-1 å¯è¡¨ç¤ºçš„å­—ç¬¦ã€‚
>![](https://github.com/pangeq/doctument/blob/uat/image/java/jdk9-string-latin1.png)
>å¦‚æœå­—ç¬¦ä¸²ä¸­åŒ…å«çš„æ±‰å­—è¶…è¿‡ Latin-1 å¯è¡¨ç¤ºèŒƒå›´å†…çš„å­—ç¬¦ï¼Œbyte å’Œ char æ‰€å ç”¨çš„ç©ºé—´æ˜¯ä¸€æ ·çš„ã€‚
>è¿™æ˜¯å®˜æ–¹çš„ä»‹ç»ï¼šhttps://openjdk.java.net/jeps/254 ã€‚

### å­—ç¬¦ä¸²æ‹¼æ¥ç”¨â€œ+â€ è¿˜æ˜¯ StringBuilder?
>Java è¯­è¨€æœ¬èº«å¹¶ä¸æ”¯æŒè¿ç®—ç¬¦é‡è½½ï¼Œâ€œ+â€å’Œâ€œ+=â€æ˜¯ä¸“é—¨ä¸º String ç±»é‡è½½è¿‡çš„è¿ç®—ç¬¦ï¼Œä¹Ÿæ˜¯ Java ä¸­ä»…æœ‰çš„ä¸¤ä¸ªé‡è½½è¿‡çš„è¿ç®—ç¬¦ã€‚
>```java
>String str1 = "he";
>String str2 = "llo";
>String str3 = "world";
>String str4 = str1 + str2 + str3;
>```

>ä¸Šé¢çš„ä»£ç å¯¹åº”çš„å­—èŠ‚ç å¦‚ä¸‹ï¼š
>![](https://github.com/pangeq/doctument/blob/uat/image/java/image-20220422161637929.png)
>å¯ä»¥çœ‹å‡ºï¼Œå­—ç¬¦ä¸²å¯¹è±¡é€šè¿‡â€œ+â€çš„å­—ç¬¦ä¸²æ‹¼æ¥æ–¹å¼ï¼Œå®é™…ä¸Šæ˜¯é€šè¿‡ StringBuilder è°ƒç”¨ append() æ–¹æ³•å®ç°çš„ï¼Œæ‹¼æ¥å®Œæˆä¹‹åè°ƒç”¨ toString() å¾—åˆ°ä¸€ä¸ª String å¯¹è±¡ ã€‚
>ä¸è¿‡ï¼Œåœ¨å¾ªç¯å†…ä½¿ç”¨â€œ+â€è¿›è¡Œå­—ç¬¦ä¸²çš„æ‹¼æ¥çš„è¯ï¼Œå­˜åœ¨æ¯”è¾ƒæ˜æ˜¾çš„ç¼ºé™·ï¼š**ç¼–è¯‘å™¨ä¸ä¼šåˆ›å»ºå•ä¸ª StringBuilder ä»¥å¤ç”¨ï¼Œä¼šå¯¼è‡´åˆ›å»ºè¿‡å¤šçš„ StringBuilder å¯¹è±¡ã€‚** 
>```java
>String[] arr = {"he", "llo", "world"};
>String s = "";
>for (int i = 0; i < arr.length; i++) {
>    s += arr[i];
>}
>System.out.println(s);
>```

>StringBuilder å¯¹è±¡æ˜¯åœ¨å¾ªç¯å†…éƒ¨è¢«åˆ›å»ºçš„ï¼Œè¿™æ„å‘³ç€æ¯å¾ªç¯ä¸€æ¬¡å°±ä¼šåˆ›å»ºä¸€ä¸ª StringBuilder å¯¹è±¡ã€‚
>![](https://github.com/pangeq/doctument/blob/uat/image/java/image-20220422161320823.png)
>å¦‚æœç›´æ¥ä½¿ç”¨ StringBuilder å¯¹è±¡è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥çš„è¯ï¼Œå°±ä¸ä¼šå­˜åœ¨è¿™ä¸ªé—®é¢˜äº†ã€‚
>```java
>String[] arr = {"he", "llo", "world"};
>StringBuilder s = new StringBuilder();
>for (String value : arr) {
>    s.append(value);
>}
>System.out.println(s);
>```

>![](https://github.com/pangeq/doctument/blob/uat/image/java/image-20220422162327415.png)
>å¦‚æœä½ ä½¿ç”¨ IDEA çš„è¯ï¼ŒIDEA è‡ªå¸¦çš„ä»£ç æ£€æŸ¥æœºåˆ¶ä¹Ÿä¼šæç¤ºä½ ä¿®æ”¹ä»£ç ã€‚
>ä¸è¿‡ï¼Œä½¿ç”¨ â€œ+â€ è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥ä¼šäº§ç”Ÿå¤§é‡çš„ä¸´æ—¶å¯¹è±¡çš„é—®é¢˜åœ¨ JDK9 ä¸­å¾—åˆ°äº†è§£å†³ã€‚åœ¨ JDK9 å½“ä¸­ï¼Œå­—ç¬¦ä¸²ç›¸åŠ  â€œ+â€ æ”¹ä¸ºäº†ç”¨åŠ¨æ€æ–¹æ³• makeConcatWithConstants() æ¥å®ç°ï¼Œè€Œä¸æ˜¯å¤§é‡çš„ StringBuilder äº†ã€‚è¿™ä¸ªæ”¹è¿›æ˜¯ JDK9 çš„ JEP 280open in new window æå‡ºçš„ï¼Œè¿™ä¹Ÿæ„å‘³ç€ JDK 9 ä¹‹åï¼Œä½ å¯ä»¥æ”¾å¿ƒä½¿ç”¨â€œ+â€ è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥äº†ã€‚å…³äºè¿™éƒ¨åˆ†æ”¹è¿›çš„è¯¦ç»†ä»‹ç»ï¼Œæ¨èé˜…è¯»è¿™ç¯‡æ–‡ç« ï¼šè¿˜åœ¨æ— è„‘ç”¨[ StringBuilderï¼Ÿæ¥é‡æ¸©ä¸€ä¸‹å­—ç¬¦ä¸²æ‹¼æ¥å§](https://juejin.cn/post/7182872058743750715)

### String#equals() å’Œ Object#equals() æœ‰ä½•åŒºåˆ«ï¼Ÿ
>String ä¸­çš„ equals æ–¹æ³•æ˜¯è¢«é‡å†™è¿‡çš„ï¼Œæ¯”è¾ƒçš„æ˜¯ String å­—ç¬¦ä¸²çš„å€¼æ˜¯å¦ç›¸ç­‰ã€‚ Object çš„ equals æ–¹æ³•æ˜¯æ¯”è¾ƒçš„å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚

### å­—ç¬¦ä¸²å¸¸é‡æ± çš„ä½œç”¨äº†è§£å—ï¼Ÿ
>**å­—ç¬¦ä¸²å¸¸é‡æ± ** æ˜¯ JVM ä¸ºäº†æå‡æ€§èƒ½å’Œå‡å°‘å†…å­˜æ¶ˆè€—é’ˆå¯¹å­—ç¬¦ä¸²ï¼ˆString ç±»ï¼‰ä¸“é—¨å¼€è¾Ÿçš„ä¸€å—åŒºåŸŸï¼Œä¸»è¦ç›®çš„æ˜¯ä¸ºäº†é¿å…å­—ç¬¦ä¸²çš„é‡å¤åˆ›å»ºã€‚
>```java
>// åœ¨å †ä¸­åˆ›å»ºå­—ç¬¦ä¸²å¯¹è±¡â€abâ€œ
>// å°†å­—ç¬¦ä¸²å¯¹è±¡â€abâ€œçš„å¼•ç”¨ä¿å­˜åœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­
>String aa = "ab";
>// ç›´æ¥è¿”å›å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å­—ç¬¦ä¸²å¯¹è±¡â€abâ€œçš„å¼•ç”¨
>String bb = "ab";
>System.out.println(aa==bb);// true
>```

>æ›´å¤šå…³äºå­—ç¬¦ä¸²å¸¸é‡æ± çš„ä»‹ç»å¯ä»¥çœ‹ä¸€ä¸‹ [Java å†…å­˜åŒºåŸŸè¯¦è§£](https://javaguide.cn/java/jvm/memory-area.html) è¿™ç¯‡æ–‡ç« 

### String s1 = new String("abc");è¿™å¥è¯åˆ›å»ºäº†å‡ ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Ÿ
>ä¼šåˆ›å»º 1 æˆ– 2 ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ã€‚
>- å¦‚æœå­—ç¬¦ä¸²å¸¸é‡æ± ä¸­ä¸å­˜åœ¨å­—ç¬¦ä¸²å¯¹è±¡â€œabcâ€çš„å¼•ç”¨ï¼Œé‚£ä¹ˆä¼šåœ¨å †ä¸­åˆ›å»º 2 ä¸ªå­—ç¬¦ä¸²å¯¹è±¡â€œabcâ€ã€‚
>ç¤ºä¾‹ä»£ç ï¼ˆJDK 1.8ï¼‰ï¼š
>```java
>String s1 = new String("abc");
>```

>å¯¹åº”çš„å­—èŠ‚ç ï¼š
>![](https://github.com/pangeq/doctument/blob/uat/image/java/image-20220413175809959.png)
>ldc å‘½ä»¤ç”¨äºåˆ¤æ–­å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­æ˜¯å¦ä¿å­˜äº†å¯¹åº”çš„å­—ç¬¦ä¸²å¯¹è±¡çš„å¼•ç”¨ï¼Œå¦‚æœä¿å­˜äº†çš„è¯ç›´æ¥è¿”å›ï¼Œå¦‚æœæ²¡æœ‰ä¿å­˜çš„è¯ï¼Œä¼šåœ¨å †ä¸­åˆ›å»ºå¯¹åº”çš„å­—ç¬¦ä¸²å¯¹è±¡å¹¶å°†è¯¥å­—ç¬¦ä¸²å¯¹è±¡çš„å¼•ç”¨ä¿å­˜åˆ°å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­ã€‚
>- å¦‚æœå­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å·²å­˜åœ¨å­—ç¬¦ä¸²å¯¹è±¡â€œabcâ€çš„å¼•ç”¨ï¼Œåˆ™åªä¼šåœ¨å †ä¸­åˆ›å»º 1 ä¸ªå­—ç¬¦ä¸²å¯¹è±¡â€œabcâ€ã€‚
>ç¤ºä¾‹ä»£ç ï¼ˆJDK 1.8ï¼‰ï¼š
>```java
>// å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å·²å­˜åœ¨å­—ç¬¦ä¸²å¯¹è±¡â€œabcâ€çš„å¼•ç”¨
>String s1 = "abc";
>// ä¸‹é¢è¿™æ®µä»£ç åªä¼šåœ¨å †ä¸­åˆ›å»º 1 ä¸ªå­—ç¬¦ä¸²å¯¹è±¡â€œabcâ€
>String s2 = new String("abc");
>```

>å¯¹åº”çš„å­—èŠ‚ç ï¼š
>![](https://github.com/pangeq/doctument/blob/uat/image/java/image-20220413180021072.png)
>è¿™é‡Œå°±ä¸å¯¹ä¸Šé¢çš„å­—èŠ‚ç è¿›è¡Œè¯¦ç»†æ³¨é‡Šäº†ï¼Œ7 è¿™ä¸ªä½ç½®çš„ ldc å‘½ä»¤ä¸ä¼šåœ¨å †ä¸­åˆ›å»ºæ–°çš„å­—ç¬¦ä¸²å¯¹è±¡â€œabcâ€ï¼Œè¿™æ˜¯å› ä¸º 0 è¿™ä¸ªä½ç½®å·²ç»æ‰§è¡Œäº†ä¸€æ¬¡ ldc å‘½ä»¤ï¼Œå·²ç»åœ¨å †ä¸­åˆ›å»ºè¿‡ä¸€æ¬¡å­—ç¬¦ä¸²å¯¹è±¡â€œabcâ€äº†ã€‚7 è¿™ä¸ªä½ç½®æ‰§è¡Œ ldc å‘½ä»¤ä¼šç›´æ¥è¿”å›å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å­—ç¬¦ä¸²å¯¹è±¡â€œabcâ€å¯¹åº”çš„å¼•ç”¨ã€‚

### String#intern æ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨?
>String.intern() æ˜¯ä¸€ä¸ª nativeï¼ˆæœ¬åœ°ï¼‰æ–¹æ³•ï¼Œå…¶ä½œç”¨æ˜¯å°†æŒ‡å®šçš„å­—ç¬¦ä¸²å¯¹è±¡çš„å¼•ç”¨ä¿å­˜åœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­ï¼Œå¯ä»¥ç®€å•åˆ†ä¸ºä¸¤ç§æƒ…å†µ:
>- å¦‚æœå­—ç¬¦ä¸²å¸¸é‡æ± ä¸­ä¿å­˜äº†å¯¹åº”çš„å­—ç¬¦ä¸²å¯¹è±¡çš„å¼•ç”¨ï¼Œå°±ç›´æ¥è¿”å›è¯¥å¼•ç”¨ã€‚
>- å¦‚æœå­—ç¬¦ä¸²å¸¸é‡æ± ä¸­æ²¡æœ‰ä¿å­˜äº†å¯¹åº”çš„å­—ç¬¦ä¸²å¯¹è±¡çš„å¼•ç”¨ï¼Œé‚£å°±åœ¨å¸¸é‡æ± ä¸­åˆ›å»ºä¸€ä¸ªæŒ‡å‘è¯¥å­—ç¬¦ä¸²å¯¹è±¡çš„å¼•ç”¨å¹¶è¿”å›ã€‚
>ç¤ºä¾‹ä»£ç ï¼ˆJDK 1.8ï¼‰ :
>```java
>// åœ¨å †ä¸­åˆ›å»ºå­—ç¬¦ä¸²å¯¹è±¡â€Javaâ€œ
>// å°†å­—ç¬¦ä¸²å¯¹è±¡â€Javaâ€œçš„å¼•ç”¨ä¿å­˜åœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­
>String s1 = "Java";
>// ç›´æ¥è¿”å›å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å­—ç¬¦ä¸²å¯¹è±¡â€Javaâ€œå¯¹åº”çš„å¼•ç”¨
>String s2 = s1.intern();
>// ä¼šåœ¨å †ä¸­åœ¨å•ç‹¬åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡
>String s3 = new String("Java");
>// ç›´æ¥è¿”å›å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å­—ç¬¦ä¸²å¯¹è±¡â€Javaâ€œå¯¹åº”çš„å¼•ç”¨
>String s4 = s3.intern();
>// s1 å’Œ s2 æŒ‡å‘çš„æ˜¯å †ä¸­çš„åŒä¸€ä¸ªå¯¹è±¡
>System.out.println(s1 == s2); // true
>// s3 å’Œ s4 æŒ‡å‘çš„æ˜¯å †ä¸­ä¸åŒçš„å¯¹è±¡
>System.out.println(s3 == s4); // false
>// s1 å’Œ s4 æŒ‡å‘çš„æ˜¯å †ä¸­çš„åŒä¸€ä¸ªå¯¹è±¡
>System.out.println(s1 == s4); //true
>```

### String ç±»å‹çš„å˜é‡å’Œå¸¸é‡åšâ€œ+â€è¿ç®—æ—¶å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ
>å…ˆæ¥çœ‹å­—ç¬¦ä¸²ä¸åŠ  final å…³é”®å­—æ‹¼æ¥çš„æƒ…å†µï¼ˆJDK1.8ï¼‰ï¼š
>```java
>String str1 = "str";
>String str2 = "ing";
>String str3 = "str" + "ing";
>String str4 = str1 + str2;
>String str5 = "string";
>System.out.println(str3 == str4);//false
>System.out.println(str3 == str5);//true
>System.out.println(str4 == str5);//false
>```

>æ³¨æ„ï¼šæ¯”è¾ƒ String å­—ç¬¦ä¸²çš„å€¼æ˜¯å¦ç›¸ç­‰ï¼Œå¯ä»¥ä½¿ç”¨ equals() æ–¹æ³•ã€‚ String ä¸­çš„ equals æ–¹æ³•æ˜¯è¢«é‡å†™è¿‡çš„ã€‚ Object çš„ equals æ–¹æ³•æ˜¯æ¯”è¾ƒçš„å¯¹è±¡çš„å†…å­˜åœ°å€ï¼Œè€Œ String çš„ equals æ–¹æ³•æ¯”è¾ƒçš„æ˜¯å­—ç¬¦ä¸²çš„å€¼æ˜¯å¦ç›¸ç­‰ã€‚å¦‚æœä½ ä½¿ç”¨ == æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰çš„è¯ï¼ŒIDEA è¿˜æ˜¯æç¤ºä½ ä½¿ç”¨ equals() æ–¹æ³•æ›¿æ¢ã€‚
>![](https://github.com/pangeq/doctument/blob/uat/image/java/image-20210817123252441.png)
>**å¯¹äºç¼–è¯‘æœŸå¯ä»¥ç¡®å®šå€¼çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯å¸¸é‡å­—ç¬¦ä¸² ï¼Œjvm ä¼šå°†å…¶å­˜å…¥å­—ç¬¦ä¸²å¸¸é‡æ± ã€‚å¹¶ä¸”ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ‹¼æ¥å¾—åˆ°çš„å­—ç¬¦ä¸²å¸¸é‡åœ¨ç¼–è¯‘é˜¶æ®µå°±å·²ç»è¢«å­˜æ”¾å­—ç¬¦ä¸²å¸¸é‡æ± ï¼Œè¿™ä¸ªå¾—ç›Šäºç¼–è¯‘å™¨çš„ä¼˜åŒ–ã€‚**
>åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼ŒJavac ç¼–è¯‘å™¨ï¼ˆä¸‹æ–‡ä¸­ç»Ÿç§°ä¸ºç¼–è¯‘å™¨ï¼‰ä¼šè¿›è¡Œä¸€ä¸ªå«åš å¸¸é‡æŠ˜å (Constant Folding) çš„ä»£ç ä¼˜åŒ–ã€‚ã€Šæ·±å…¥ç†è§£ Java è™šæ‹Ÿæœºã€‹ä¸­æ˜¯ä¹Ÿæœ‰ä»‹ç»åˆ°ï¼š
>![](https://github.com/pangeq/doctument/blob/uat/image/java/image-20210817142715396.png)
>å¸¸é‡æŠ˜å ä¼šæŠŠå¸¸é‡è¡¨è¾¾å¼çš„å€¼æ±‚å‡ºæ¥ä½œä¸ºå¸¸é‡åµŒåœ¨æœ€ç»ˆç”Ÿæˆçš„ä»£ç ä¸­ï¼Œè¿™æ˜¯ Javac ç¼–è¯‘å™¨ä¼šå¯¹æºä»£ç åšçš„æå°‘é‡ä¼˜åŒ–æªæ–½ä¹‹ä¸€(ä»£ç ä¼˜åŒ–å‡ ä¹éƒ½åœ¨å³æ—¶ç¼–è¯‘å™¨ä¸­è¿›è¡Œ)ã€‚
>å¯¹äº String str3 = "str" + "ing"; ç¼–è¯‘å™¨ä¼šç»™ä½ ä¼˜åŒ–æˆ String str3 = "string"; ã€‚
>å¹¶ä¸æ˜¯æ‰€æœ‰çš„å¸¸é‡éƒ½ä¼šè¿›è¡ŒæŠ˜å ï¼Œåªæœ‰ç¼–è¯‘å™¨åœ¨ç¨‹åºç¼–è¯‘æœŸå°±å¯ä»¥ç¡®å®šå€¼çš„å¸¸é‡æ‰å¯ä»¥ï¼š
>- åŸºæœ¬æ•°æ®ç±»å‹( byteã€booleanã€shortã€charã€intã€floatã€longã€double)ä»¥åŠå­—ç¬¦ä¸²å¸¸é‡ã€‚
>final ä¿®é¥°çš„åŸºæœ¬æ•°æ®ç±»å‹å’Œå­—ç¬¦ä¸²å˜é‡
>- å­—ç¬¦ä¸²é€šè¿‡ â€œ+â€æ‹¼æ¥å¾—åˆ°çš„å­—ç¬¦ä¸²ã€åŸºæœ¬æ•°æ®ç±»å‹ä¹‹é—´ç®—æ•°è¿ç®—ï¼ˆåŠ å‡ä¹˜é™¤ï¼‰ã€åŸºæœ¬æ•°æ®ç±»å‹çš„ä½è¿ç®—ï¼ˆ<<ã€>>ã€>>> ï¼‰
>**å¼•ç”¨çš„å€¼åœ¨ç¨‹åºç¼–è¯‘æœŸæ˜¯æ— æ³•ç¡®å®šçš„ï¼Œç¼–è¯‘å™¨æ— æ³•å¯¹å…¶è¿›è¡Œä¼˜åŒ–ã€‚**
>å¯¹è±¡å¼•ç”¨å’Œâ€œ+â€çš„å­—ç¬¦ä¸²æ‹¼æ¥æ–¹å¼ï¼Œå®é™…ä¸Šæ˜¯é€šè¿‡ StringBuilder è°ƒç”¨ append() æ–¹æ³•å®ç°çš„ï¼Œæ‹¼æ¥å®Œæˆä¹‹åè°ƒç”¨ toString() å¾—åˆ°ä¸€ä¸ª String å¯¹è±¡ ã€‚
>```java
>String str4 = new StringBuilder().append(str1).append(str2).toString();
>```

>æˆ‘ä»¬åœ¨å¹³æ—¶å†™ä»£ç çš„æ—¶å€™ï¼Œå°½é‡é¿å…å¤šä¸ªå­—ç¬¦ä¸²å¯¹è±¡æ‹¼æ¥ï¼Œå› ä¸ºè¿™æ ·ä¼šé‡æ–°åˆ›å»ºå¯¹è±¡ã€‚å¦‚æœéœ€è¦æ”¹å˜å­—ç¬¦ä¸²çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ StringBuilder æˆ–è€… StringBufferã€‚
>ä¸è¿‡ï¼Œå­—ç¬¦ä¸²ä½¿ç”¨ final å…³é”®å­—å£°æ˜ä¹‹åï¼Œå¯ä»¥è®©ç¼–è¯‘å™¨å½“åšå¸¸é‡æ¥å¤„ç†ã€‚
>ç¤ºä¾‹ä»£ç ï¼š
>```java
>final String str1 = "str";
>final String str2 = "ing";
>// ä¸‹é¢ä¸¤ä¸ªè¡¨è¾¾å¼å…¶å®æ˜¯ç­‰ä»·çš„
>String c = "str" + "ing";// å¸¸é‡æ± ä¸­çš„å¯¹è±¡
>String d = str1 + str2; // å¸¸é‡æ± ä¸­çš„å¯¹è±¡
>System.out.println(c == d);// true
>```

>è¢« final å…³é”®å­—ä¿®æ”¹ä¹‹åçš„ String ä¼šè¢«ç¼–è¯‘å™¨å½“åšå¸¸é‡æ¥å¤„ç†ï¼Œç¼–è¯‘å™¨åœ¨ç¨‹åºç¼–è¯‘æœŸå°±å¯ä»¥ç¡®å®šå®ƒçš„å€¼ï¼Œå…¶æ•ˆæœå°±ç›¸å½“äºè®¿é—®å¸¸é‡ã€‚
>å¦‚æœ ï¼Œç¼–è¯‘å™¨åœ¨è¿è¡Œæ—¶æ‰èƒ½çŸ¥é“å…¶ç¡®åˆ‡å€¼çš„è¯ï¼Œå°±æ— æ³•å¯¹å…¶ä¼˜åŒ–ã€‚
>ç¤ºä¾‹ä»£ç ï¼ˆstr2 åœ¨è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šå…¶å€¼ï¼‰ï¼š
>```java
>final String str1 = "str";
>final String str2 = getStr();
>String c = "str" + "ing";// å¸¸é‡æ± ä¸­çš„å¯¹è±¡
>String d = str1 + str2; // åœ¨å †ä¸Šåˆ›å»ºçš„æ–°çš„å¯¹è±¡
>System.out.println(c == d);// false
>public static String getStr() {
>      return "ing";
>}
>
>```

## å‚è€ƒ
>- æ·±å…¥è§£æ [String#intern](https://tech.meituan.com/2014/03/06/in-depth-understanding-string-intern.html)
>- R å¤§ï¼ˆRednaxelaFXï¼‰å…³äºå¸¸é‡æŠ˜å çš„å›ç­”ï¼š[å¸¸é‡æŠ˜å ](https://www.zhihu.com/question/55976094/answer/147302764)